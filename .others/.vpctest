Got it â€” letâ€™s simplify everything into VERY clear, step-by-step checks so you can immediately verify whether routing is correct for your Kubernetes cluster to reach the AWS S3 VPC endpoint.

â¸»

âœ… Goal

Check whether your on-prem Kubernetes subnet is correctly routed to the AWS S3 Interface Endpoint ENI IPs.

If routing is wrong â†’ S3 PrivateLink will TIME OUT (your exact problem).

â¸»

â­ VERY CLEAR STEPS (Follow exactly in this order)

â¸»

ğŸ”¶ STEP 1 â€” Find the Private Endpoint ENI IPs

These are the IPs your kube cluster must reach.
	1.	Go to AWS Console
	2.	Open VPC â†’ Endpoints
	3.	Click your S3 Interface Endpoint
	4.	Scroll to Network Interfaces
	5.	For each ENI, note the IPv4 address

Example output you will see:

10.12.4.25
10.12.5.30
10.12.6.14

âœ” You need these IPs for routing tests.

â¸»

ğŸ”¶ STEP 2 â€” Check the Route Table of Those Subnets

Each ENI sits in a particular subnet, and each subnet has a route table.

Do this:
	1.	Click each ENI (from Step 1)
	2.	Look for Subnet ID
Example: subnet-abc123
	3.	Scroll down â†’ â€œSubnetâ€ section â†’ It will show:
Route Table â†’ rtb-xxxxxx (click it)

Now you are inside the correct route table.

Look for a route like:

(on-prem Kube subnet) â†’ VGW (or DXGW or TGW)

Example:

172.16.50.0/24 â†’ vgw-1234abcd

âœ” If your local machine subnet is present

BUT

âŒ your kube subnet is missing

â†’ This is your exact problem

âš ï¸ MOST COMMON FAILURE:

Local machine subnet is routed
Kube cluster subnet IS NOT routed


â¸»

ğŸ”¶ STEP 3 â€” Check Your On-Prem Firewall Routing

(ONLY 1 question to answer)

Is your kube VLAN routed to AWS VPC the same way as your local machine VLAN?

On firewall:

AWS VPC CIDR (example 10.0.0.0/16) â†’ VPN tunnel or Direct Connect

If firewall routes:
	â€¢	Local machine subnet â†’ VPN1
	â€¢	Kube subnet â†’ VPN2 (missing AWS route)

Then only your local will work.

This is VERY common.

â¸»

ğŸ”¶ STEP 4 â€” Perform a Reachability Analyzer Test

This gives a VISUAL answer.
	1.	AWS Console â†’ VPC â†’ Reachability Analyzer
	2.	Click Create a Path
	3.	Source = Your on-prem kube cluster IP
(Manually enter it)
	4.	Destination = The S3 VPC endpoint ENI IP (from Step 1)

Run test.

âœ” If SUCCESS â†’ Routing OK

âŒ If FAILURE â†’ AWS shows where the routing breaks

(e.g., missing route, blocked SG, invalid path)

â¸»

ğŸ”¶ STEP 5 â€” Simple Yes/No Routing Questions (Automatic Diagnosis)

Answer these:

1ï¸âƒ£ Does the VPC route table contain your kube subnet CIDR pointing to VPN/DX?

If NO â†’ routing is broken.

2ï¸âƒ£ Does the firewall route your kube subnet into the same tunnel used by your local machine?

If NO â†’ routing is broken.

3ï¸âƒ£ Does DNS resolve S3 to a 10.x.x.x private IP from kube?

Run this inside a kube node:

nslookup s3.<region>.amazonaws.com

If result is public IP, kube is NOT using the VPCâ€™s DNS â†’ routing cannot work.

4ï¸âƒ£ Does AWS Reachability Analyzer show failure?

If YES â†’ AWS side routing is broken.

â¸»

â­ If you ONLY check these 3 items, you will find the root cause

âœ” Check VPC route table for KUBE subnet (Step 2)

âœ” Check firewall routing for KUBE subnet (Step 3)

âœ” Check DNS from KUBE node (Step 5)

You will find EXACTLY why local works and kube doesnâ€™t.

â¸»

ğŸ”¥ Want me to help you identify the problem instantly?

Just provide:
	1.	Your AWS VPC CIDR
	2.	Your on-prem local machine subnet
	3.	Your on-prem kube cluster subnet
	4.	The S3 endpoint subnet (from Step 1)

I will tell you exactly which route is missing.