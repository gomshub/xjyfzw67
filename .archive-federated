While some SQL databases support querying across multiple databases on the same server, querying across databases on different servers is more complex and typically requires using a data integration tool or middleware. However, if both databases are on the same server or if your database system supports federated queries, you can directly achieve this without extracting to CSV.

### MySQL Example with Federated Tables

In MySQL, you can use the `FEDERATED` storage engine to create a table that represents a table from another server. Hereâ€™s how you can achieve this:

1. **Configure the Federated Storage Engine**:
   - Ensure the `FEDERATED` storage engine is enabled in your MySQL server. You may need to modify the MySQL configuration file (`my.cnf` or `my.ini`) to include `federated` in the `--plugin-load` parameter.

2. **Create Federated Table**:
   - Create a federated table on the archive database that points to the transactions table on the main database.

3. **Insert Data via SQL Query**:
   - Use an `INSERT INTO ... SELECT` statement to move the data.

### Step-by-Step Guide

#### 1. Ensure Federated Engine is Enabled

In your MySQL configuration file (`my.cnf` or `my.ini`), ensure the `federated` engine is enabled:

```ini
[mysqld]
federated
```

Restart the MySQL service after making this change.

#### 2. Create a Federated Table

Create a federated table in the archive database that points to the transactions table in the main database.

```sql
CREATE TABLE federated_transactions (
    transaction_id INT,
    transaction_date DATE,
    amount DECIMAL(10,2),
    -- Add other columns as needed
) ENGINE=FEDERATED
CONNECTION='mysql://main_db_user:main_db_pass@main_db_host/main_db/transactions';
```

#### 3. Insert Data via SQL Query

You can now use an `INSERT INTO ... SELECT` query to move data from the main database to the archive database.

```sql
INSERT INTO archive_db.archived_transactions
SELECT * FROM federated_transactions
WHERE transaction_date < DATE_SUB(CURDATE(), INTERVAL 6 MONTH);
```

### Alternative Approach: Database Link in PostgreSQL

If you are using PostgreSQL, you can achieve this using the `postgres_fdw` extension, which allows foreign data wrappers to query external PostgreSQL servers.

#### 1. Install and Configure `postgres_fdw`

```sql
-- Load the postgres_fdw extension
CREATE EXTENSION postgres_fdw;

-- Create a server definition for the remote server
CREATE SERVER main_db_server
FOREIGN DATA WRAPPER postgres_fdw
OPTIONS (host 'main_db_host', dbname 'main_db', port '5432');

-- Create user mappings
CREATE USER MAPPING FOR current_user
SERVER main_db_server
OPTIONS (user 'main_db_user', password 'main_db_pass');

-- Import the foreign schema or specific tables
IMPORT FOREIGN SCHEMA public
FROM SERVER main_db_server
INTO foreign_schema;
```

#### 2. Use Foreign Table in Queries

```sql
-- Insert data from the foreign table into the local archive table
INSERT INTO archive_db.archived_transactions
SELECT * FROM foreign_schema.transactions
WHERE transaction_date < DATE_SUB(CURDATE(), INTERVAL 6 MONTH);
```

### Summary

By using federated tables in MySQL or foreign data wrappers in PostgreSQL, you can query across databases on different servers directly within a single SQL query. This approach eliminates the need for intermediate CSV extraction and loading steps, streamlining the data archiving process. Ensure that you handle security and performance considerations appropriately when configuring and using these features.