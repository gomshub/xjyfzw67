
Yes — when S3 replication uses SSE-KMS, both the IAM replication role and the KMS key policy must explicitly allow S3 to use the key.

If any one of these is missing, replication fails.

Replication commonly fails for one of these reasons:

⸻

1️⃣ KMS key policy is missing S3 permissions

The destination bucket’s KMS key must allow S3 service + replication role:

{
  "Effect": "Allow",
  "Principal": {
    "Service": "s3.amazonaws.com"
  },
  "Action": [
    "kms:Encrypt",
    "kms:Decrypt",
    "kms:ReEncrypt*",
    "kms:GenerateDataKey*"
  ],
  "Resource": "*",
  "Condition": {
    "StringEquals": {
      "aws:SourceAccount": "<SOURCE_ACCOUNT_ID>"
    }
  }
}

And also allow the replication role:

{
  "Effect": "Allow",
  "Principal": {
    "AWS": "arn:aws:iam::<ACCOUNT_ID>:role/<ReplicationRole>"
  },
  "Action": [
    "kms:Encrypt",
    "kms:Decrypt",
    "kms:ReEncrypt*",
    "kms:GenerateDataKey*"
  ],
  "Resource": "*"
}

Without this, objects encrypted with KMS cannot be replicated.

⸻

2️⃣ Replication role missing permissions

The replication role must have:

"s3:GetObjectVersionForReplication"
"s3:GetObjectVersionAcl"
"s3:GetObjectVersionTagging"
"s3:ReplicateObject"
"s3:ReplicateDelete"
"s3:ReplicateTags"

on source and destination buckets.

⸻

3️⃣ Bucket policy blocks S3 service

If your bucket policy has:

"Effect": "Deny",
"Principal": "*",
"Action": "s3:*",
"Condition": { "StringNotEquals": { "aws:SourceVpce": "vpce-xxxx" } }

Then replication will fail unless you add an exception for the S3 service or the replication role, for example:

"Condition": {
  "StringNotEquals": {
    "aws:SourceVpce": "vpce-xxxx"
  },
  "ArnNotEquals": {
    "aws:PrincipalArn": "arn:aws:iam::<ACCOUNT_ID>:role/<ReplicationRole>"
  }
}

S3 replication does not use your VPCE.

⸻

4️⃣ Versioning not enabled on both buckets

CRR requires versioning on both source and destination.

⸻

5️⃣ How to see the exact failure reason

In S3 Console:
	•	Bucket → Management → Replication
	•	Open the rule → “View details”
	•	Check Replication status and Failure reason

Or via CLI:

aws s3api list-objects-v2 --bucket <source-bucket> --query 'Contents[].ReplicationStatus'


⸻

In short

Replication fails if any of these is missing:
	•	KMS key policy allows S3 + replication role
	•	Replication role has correct S3 permissions
	•	Bucket policy does not block the replication role
	•	Versioning enabled on both buckets

In KMS-based setups, KMS policy is the most common root cause.




Below is a single clear view of what each policy is responsible for in your two-region S3 replication with KMS setup.

Assume:
	•	Source bucket: bucket-eu-west-1
	•	Destination bucket: bucket-eu-central-1
	•	Replication role: S3ReplicationRole
	•	KMS keys in both regions
	•	You enforce aws:SourceVpce in bucket policies

⸻

1️⃣ S3 Bucket Policies (Both Regions)

Region	Policy Lives On	Principal (WHO)	Action (WHAT)	Resource (ON WHAT)	Purpose
eu-west-1 (source)	bucket-eu-west-1	* (everyone)	s3:*	bucket-eu-west-1 and /*	Deny all access unless via VPCE
eu-west-1 (source)	bucket-eu-west-1	S3ReplicationRole	s3:GetObjectVersion*	bucket-eu-west-1/*	Allow S3 replication to read objects
eu-central-1 (dest)	bucket-eu-central-1	* (everyone)	s3:*	bucket-eu-central-1 and /*	Deny all access unless via VPCE
eu-central-1 (dest)	bucket-eu-central-1	S3ReplicationRole	s3:Replicate*	bucket-eu-central-1/*	Allow S3 replication to write objects

Key idea:
Your Deny with aws:SourceVpce must have an exception for S3ReplicationRole, because replication does not use your VPCE.

⸻

2️⃣ S3 Replication IAM Role (S3ReplicationRole)

Policy Element	Value	Meaning
Principal (Trust Policy)	s3.amazonaws.com	Allows S3 service to assume this role
Actions	s3:GetObjectVersion* on source	Read versioned objects
Actions	s3:ReplicateObject, s3:ReplicateDelete, s3:ReplicateTags on destination	Write replicas
Resources	Source bucket ARNs	Read permission
Resources	Destination bucket ARNs	Write permission

This role is what S3 “becomes” when it performs replication.

⸻

3️⃣ KMS Key Policies (Both Regions)

Region	Policy Lives On	Principal (WHO)	Action (WHAT)	Resource (ON WHAT)	Purpose
eu-west-1	KMS key for source bucket	S3ReplicationRole	kms:Decrypt	This KMS key	Allow reading encrypted objects
eu-west-1	KMS key for source bucket	s3.amazonaws.com	kms:GenerateDataKey*	This KMS key	Allow S3 to handle crypto
eu-central-1	KMS key for dest bucket	S3ReplicationRole	kms:Encrypt, kms:ReEncrypt*	This KMS key	Allow writing encrypted replicas
eu-central-1	KMS key for dest bucket	s3.amazonaws.com	kms:Encrypt, kms:GenerateDataKey*	This KMS key	Allow S3 service to encrypt

Without these KMS permissions, replication of SSE-KMS objects always fails, even if S3 and IAM policies are correct.

⸻

One-line mental model
	•	Bucket policy controls who may touch the bucket
	•	Replication role defines what S3 is allowed to do
	•	KMS policy controls who may encrypt/decrypt objects

All three must align for replication to succeed across regions.



Below is a single clear view of what each policy is responsible for in your two-region S3 replication with KMS setup.

Assume:
	•	Source bucket: bucket-eu-west-1
	•	Destination bucket: bucket-eu-central-1
	•	Replication role: S3ReplicationRole
	•	KMS keys in both regions
	•	You enforce aws:SourceVpce in bucket policies

⸻

1️⃣ S3 Bucket Policies (Both Regions)

Region	Policy Lives On	Principal (WHO)	Action (WHAT)	Resource (ON WHAT)	Purpose
eu-west-1 (source)	bucket-eu-west-1	* (everyone)	s3:*	bucket-eu-west-1 and /*	Deny all access unless via VPCE
eu-west-1 (source)	bucket-eu-west-1	S3ReplicationRole	s3:GetObjectVersion*	bucket-eu-west-1/*	Allow S3 replication to read objects
eu-central-1 (dest)	bucket-eu-central-1	* (everyone)	s3:*	bucket-eu-central-1 and /*	Deny all access unless via VPCE
eu-central-1 (dest)	bucket-eu-central-1	S3ReplicationRole	s3:Replicate*	bucket-eu-central-1/*	Allow S3 replication to write objects

Key idea:
Your Deny with aws:SourceVpce must have an exception for S3ReplicationRole, because replication does not use your VPCE.

⸻

2️⃣ S3 Replication IAM Role (S3ReplicationRole)

Policy Element	Value	Meaning
Principal (Trust Policy)	s3.amazonaws.com	Allows S3 service to assume this role
Actions	s3:GetObjectVersion* on source	Read versioned objects
Actions	s3:ReplicateObject, s3:ReplicateDelete, s3:ReplicateTags on destination	Write replicas
Resources	Source bucket ARNs	Read permission
Resources	Destination bucket ARNs	Write permission

This role is what S3 “becomes” when it performs replication.

⸻

3️⃣ KMS Key Policies (Both Regions)

Region	Policy Lives On	Principal (WHO)	Action (WHAT)	Resource (ON WHAT)	Purpose
eu-west-1	KMS key for source bucket	S3ReplicationRole	kms:Decrypt	This KMS key	Allow reading encrypted objects
eu-west-1	KMS key for source bucket	s3.amazonaws.com	kms:GenerateDataKey*	This KMS key	Allow S3 to handle crypto
eu-central-1	KMS key for dest bucket	S3ReplicationRole	kms:Encrypt, kms:ReEncrypt*	This KMS key	Allow writing encrypted replicas
eu-central-1	KMS key for dest bucket	s3.amazonaws.com	kms:Encrypt, kms:GenerateDataKey*	This KMS key	Allow S3 service to encrypt

Without these KMS permissions, replication of SSE-KMS objects always fails, even if S3 and IAM policies are correct.

⸻

One-line mental model
	•	Bucket policy controls who may touch the bucket
	•	Replication role defines what S3 is allowed to do
	•	KMS policy controls who may encrypt/decrypt objects

All three must align for replication to succeed across regions.